<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <title>Novo usuário | Portal</title>
  <link rel="stylesheet" href="/css/dashboard.css" />
</head>
<body class="dashboard-page">

<div class="layout">

  <!-- SIDEBAR -->
  <aside class="sidebar">
    <div class="sidebar-logo">
      <img src="/img/logo.png" alt="Logo da empresa">
    </div>

    <nav class="sidebar-menu">
      <a href="/dashboard?module=PLEX" class="sidebar-item" data-module="PLEX">
        PLEX
      </a>
      <a href="/dashboard?module=GDR" class="sidebar-item" data-module="GDR">
        Gerenciamento Diário da Rotina
      </a>
      <a href="/dashboard?module=UGB" class="sidebar-item" data-module="UGB">
        UGB
      </a>
      <a href="/users" class="sidebar-item active" data-module="USERS">
        Usuários
      </a>

      <a href="/departments" class="sidebar-item" data-module="DEPARTMENTS">
        Departamentos
      </a>
    </nav>

    <div class="sidebar-footer">
      <a href="/logout" class="sidebar-logout">Sair</a>
    </div>
  </aside>

  <!-- CONTEÚDO -->
  <main class="content">
    <header class="dashboard-header">
      <div class="dashboard-header-left">
        <h1 class="dashboard-title">Novo usuário</h1>
        <p class="dashboard-subtitle">Cadastro de usuários do portal</p>
      </div>

      <div class="dashboard-header-right">
        <span class="dashboard-user-email"><%= user.email %></span>
      </div>
    </header>

    <section class="dashboard-panel">
      <div class="dashboard-panel-header">
        <h2 class="dashboard-panel-title">Dados do usuário</h2>
      </div>

      <% if (error) { %>
        <p class="users-form-error"><%= error %></p>
      <% } %>

        <form class="user-form" method="POST" action="/users/new">

        <div class="form-row">
            <label for="nome">Nome</label>
            <input type="text" id="nome" name="nome" required />
        </div>

        <div class="form-row">
            <label for="cpf">CPF</label>
            <input type="text" id="cpf" name="cpf" required placeholder="000.000.000-00" />
        </div>

        <div class="form-row">
            <label for="email">E-mail</label>
            <input type="email" id="email" name="email" required />
        </div>

        <div class="form-row">
            <label for="senha">Senha</label>
            <input type="password" id="senha" name="senha" required />
        </div>

        <!-- MÚLTIPLOS DEPARTAMENTOS -->
        
        <div class="form-row">
          <label>Departamentos</label>

          <% if (!departments || departments.length === 0) { %>
            <div style="opacity:.8;">Nenhum departamento cadastrado. Cadastre em “Departamentos”.</div>
          <% } else { %>
            <% departments.forEach(d => { %>
              <label class="checkbox-label">
                <input type="checkbox" name="departamentos" value="<%= d.id %>" />
                <%= d.nome %>
              </label>
            <% }) %>
          <% } %>
        </div>

        <!-- MÚLTIPLOS RELATÓRIOS -->
        <div class="form-row">
            <label>Relatórios liberados</label>

            <label class="checkbox-label">
            <input type="checkbox" name="relatorios" value="PLEX" />
            PLEX
            </label>

            <label class="checkbox-label">
            <input type="checkbox" name="relatorios" value="GDR" />
            GDR
            </label>

            <label class="checkbox-label">
            <input type="checkbox" name="relatorios" value="UGB" />
            UGB
            </label>
        </div>

        <div class="form-row form-row-inline">
            <label class="checkbox-label">
            <input type="checkbox" name="ativo" checked />
            Usuário ativo
            </label>
        </div>

        <div class="form-row form-row-inline">
          <label class="checkbox-label">
            <input type="checkbox" name="isAdmin" />
            Admin
          </label>
        </div>

        <div class="form-actions">
            <a href="/users" class="btn-secondary">Cancelar</a>
            <button type="submit" class="btn-primary">Salvar usuário</button>
        </div>
        </form>

    </section>
  </main>
</div>

</body>
</html>
